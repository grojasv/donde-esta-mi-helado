---
// Import global styles with Tailwind CSS
import '../styles/global.css';
---

<html lang="es">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="generator" content={Astro.generator} />
		<meta name="description" content="Track your ice cream flavors easily - D√≥nde Est√° Mi Helado?" />
		<title>D√≥nde Est√° Mi Helado?</title>
	</head>
	<body class="bg-gradient-to-br from-blue-50 via-indigo-50 to-pink-50 min-h-screen transition-all duration-300">
		<!-- Main container with enhanced mobile-first design -->
		<div class="container mx-auto px-4 py-8 max-w-md">
			<!-- App header with improved animations -->
			<header class="text-center mb-10 animate-fade-in">
				<h1 class="text-4xl font-bold text-gray-800 mb-3 tracking-tight">
					üç¶ D√≥nde Est√° Mi Helado?
				</h1>
				<p class="text-gray-600 text-base leading-relaxed">
					No te olvides de tus sabores favoritos
				</p>
				<div class="w-16 h-1 bg-gradient-to-r from-pink-300 to-blue-300 rounded-full mx-auto mt-4"></div>
			</header>

			<!-- Main content area with enhanced design -->
			<main class="animate-slide-up">
				<div class="bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl border border-white/50 p-8">
					<!-- Enhanced instructions -->
					<div class="mb-8 text-center">
						<p class="text-gray-700 text-base leading-relaxed">
							Escribe el sabor de cada helado en el campo correspondiente
						</p>
						<div class="mt-3 flex justify-center items-center gap-2 text-sm text-gray-500">
							<svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
								<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
							</svg>
							Se guarda autom√°ticamente
						</div>
					</div>

					<!-- Enhanced ice cream containers grid -->
					<div class="space-y-5">
						<!-- Container 1 - Enhanced Grey with A -->
						<div class="group flex items-center gap-5 p-4 bg-gradient-to-r from-gray-50 to-gray-100 rounded-xl border border-gray-200 hover:border-gray-300 hover:shadow-md transition-all duration-300 transform hover:scale-[1.02]">
							<div class="flex-shrink-0">
								<div class="w-18 h-18 bg-gradient-to-br from-gray-300 to-gray-400 rounded-xl flex items-center justify-center shadow-lg group-hover:shadow-xl transition-all duration-300">
									<div class="w-14 h-12 bg-gradient-to-br from-gray-400 to-gray-500 rounded-t-xl relative flex items-center justify-center shadow-inner">
										<span class="text-white font-bold text-xl drop-shadow-sm">A</span>
									</div>
								</div>
							</div>
							<div class="flex-1">
								<input 
									id="flavor-A"
									type="text" 
									placeholder="¬øQu√© sabor es?"
									data-container="A"
									class="w-full px-5 py-3 text-gray-800 bg-white/70 backdrop-blur-sm border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-gray-400 focus:border-transparent focus:bg-white text-base min-h-[48px] flavor-input transition-all duration-300 hover:bg-white/90"
								/>
							</div>
						</div>

						<!-- Container 2 - Enhanced Grey with B -->
						<div class="group flex items-center gap-5 p-4 bg-gradient-to-r from-gray-50 to-gray-100 rounded-xl border border-gray-200 hover:border-gray-300 hover:shadow-md transition-all duration-300 transform hover:scale-[1.02]">
							<div class="flex-shrink-0">
								<div class="w-18 h-18 bg-gradient-to-br from-gray-300 to-gray-400 rounded-xl flex items-center justify-center shadow-lg group-hover:shadow-xl transition-all duration-300">
									<div class="w-14 h-12 bg-gradient-to-br from-gray-400 to-gray-500 rounded-t-xl relative flex items-center justify-center shadow-inner">
										<span class="text-white font-bold text-xl drop-shadow-sm">B</span>
									</div>
								</div>
							</div>
							<div class="flex-1">
								<input 
									id="flavor-B"
									type="text" 
									placeholder="¬øQu√© sabor es?"
									data-container="B"
									class="w-full px-5 py-3 text-gray-800 bg-white/70 backdrop-blur-sm border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-gray-400 focus:border-transparent focus:bg-white text-base min-h-[48px] flavor-input transition-all duration-300 hover:bg-white/90"
								/>
							</div>
						</div>

						<!-- Container 3 - Enhanced Grey with C -->
						<div class="group flex items-center gap-5 p-4 bg-gradient-to-r from-gray-50 to-gray-100 rounded-xl border border-gray-200 hover:border-gray-300 hover:shadow-md transition-all duration-300 transform hover:scale-[1.02]">
							<div class="flex-shrink-0">
								<div class="w-18 h-18 bg-gradient-to-br from-gray-300 to-gray-400 rounded-xl flex items-center justify-center shadow-lg group-hover:shadow-xl transition-all duration-300">
									<div class="w-14 h-12 bg-gradient-to-br from-gray-400 to-gray-500 rounded-t-xl relative flex items-center justify-center shadow-inner">
										<span class="text-white font-bold text-xl drop-shadow-sm">C</span>
									</div>
								</div>
							</div>
							<div class="flex-1">
								<input 
									id="flavor-C"
									type="text" 
									placeholder="¬øQu√© sabor es?"
									data-container="C"
									class="w-full px-5 py-3 text-gray-800 bg-white/70 backdrop-blur-sm border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-gray-400 focus:border-transparent focus:bg-white text-base min-h-[48px] flavor-input transition-all duration-300 hover:bg-white/90"
								/>
							</div>
						</div>

						<!-- Container 4 - Enhanced Plain Green -->
						<div class="group flex items-center gap-5 p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl border border-green-200 hover:border-green-300 hover:shadow-md transition-all duration-300 transform hover:scale-[1.02]">
							<div class="flex-shrink-0">
								<div class="w-18 h-18 bg-gradient-to-br from-green-200 to-green-300 rounded-xl flex items-center justify-center shadow-lg group-hover:shadow-xl transition-all duration-300">
									<div class="w-14 h-12 bg-gradient-to-br from-green-500 to-emerald-600 rounded-t-xl relative shadow-inner">
									</div>
								</div>
							</div>
							<div class="flex-1">
								<input 
									id="flavor-4"
									type="text" 
									placeholder="¬øQu√© sabor es?"
									data-container="4"
									class="w-full px-5 py-3 text-gray-800 bg-white/70 backdrop-blur-sm border border-green-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-transparent focus:bg-white text-base min-h-[48px] flavor-input transition-all duration-300 hover:bg-white/90"
								/>
							</div>
						</div>

						<!-- Container 5 - Enhanced Plain Turquoise -->
						<div class="group flex items-center gap-5 p-4 bg-gradient-to-r from-cyan-50 to-teal-50 rounded-xl border border-cyan-200 hover:border-cyan-300 hover:shadow-md transition-all duration-300 transform hover:scale-[1.02]">
							<div class="flex-shrink-0">
								<div class="w-18 h-18 bg-gradient-to-br from-cyan-200 to-cyan-300 rounded-xl flex items-center justify-center shadow-lg group-hover:shadow-xl transition-all duration-300">
									<div class="w-14 h-12 bg-gradient-to-br from-cyan-500 to-teal-600 rounded-t-xl relative shadow-inner">
									</div>
								</div>
							</div>
							<div class="flex-1">
								<input 
									id="flavor-5"
									type="text" 
									placeholder="¬øQu√© sabor es?"
									data-container="5"
									class="w-full px-5 py-3 text-gray-800 bg-white/70 backdrop-blur-sm border border-cyan-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-cyan-400 focus:border-transparent focus:bg-white text-base min-h-[48px] flavor-input transition-all duration-300 hover:bg-white/90"
								/>
							</div>
						</div>

						<!-- Container 6 - Enhanced Plain Pink -->
						<div class="group flex items-center gap-5 p-4 bg-gradient-to-r from-pink-50 to-rose-50 rounded-xl border border-pink-200 hover:border-pink-300 hover:shadow-md transition-all duration-300 transform hover:scale-[1.02]">
							<div class="flex-shrink-0">
								<div class="w-18 h-18 bg-gradient-to-br from-pink-200 to-pink-300 rounded-xl flex items-center justify-center shadow-lg group-hover:shadow-xl transition-all duration-300">
									<div class="w-14 h-12 bg-gradient-to-br from-pink-500 to-rose-600 rounded-t-xl relative shadow-inner">
									</div>
								</div>
							</div>
							<div class="flex-1">
								<input 
									id="flavor-6"
									type="text" 
									placeholder="¬øQu√© sabor es?"
									data-container="6"
									class="w-full px-5 py-3 text-gray-800 bg-white/70 backdrop-blur-sm border border-pink-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-pink-400 focus:border-transparent focus:bg-white text-base min-h-[48px] flavor-input transition-all duration-300 hover:bg-white/90"
								/>
							</div>
						</div>

						<!-- Container 7 - Enhanced Plain Light Grey -->
						<div class="group flex items-center gap-5 p-4 bg-gradient-to-r from-gray-50 to-slate-50 rounded-xl border border-gray-200 hover:border-gray-300 hover:shadow-md transition-all duration-300 transform hover:scale-[1.02]">
							<div class="flex-shrink-0">
								<div class="w-18 h-18 bg-gradient-to-br from-gray-200 to-gray-300 rounded-xl flex items-center justify-center shadow-lg group-hover:shadow-xl transition-all duration-300">
									<div class="w-14 h-12 bg-gradient-to-br from-gray-300 to-slate-400 rounded-t-xl relative shadow-inner">
									</div>
								</div>
							</div>
							<div class="flex-1">
								<input 
									id="flavor-7"
									type="text" 
									placeholder="¬øQu√© sabor es?"
									data-container="7"
									class="w-full px-5 py-3 text-gray-800 bg-white/70 backdrop-blur-sm border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-gray-400 focus:border-transparent focus:bg-white text-base min-h-[48px] flavor-input transition-all duration-300 hover:bg-white/90"
								/>
							</div>
						</div>
					</div>

					<!-- Enhanced status message -->
					<div class="mt-8 text-center">
						<p id="save-status" class="text-sm text-gray-500 flex items-center justify-center gap-2 transition-all duration-300">
							<svg class="w-4 h-4 opacity-60" fill="currentColor" viewBox="0 0 20 20">
								<path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" clip-rule="evenodd"></path>
							</svg>
							Los cambios se guardar√°n autom√°ticamente
						</p>
					</div>
				</div>
			</main>
		</div>

		<!-- Enhanced client-side JavaScript with improved UX -->
		<script>
			// Storage key for localStorage
			const STORAGE_KEY = 'donde-esta-mi-helado-flavors';

			// Function to load saved flavors from localStorage
			function loadFlavors() {
				try {
					const savedFlavors = localStorage.getItem(STORAGE_KEY);
					if (savedFlavors) {
						const flavors = JSON.parse(savedFlavors);
						
						// Load each saved flavor into its corresponding input with animation
						Object.keys(flavors).forEach(containerId => {
							const input = document.getElementById(`flavor-${containerId}`);
							if (input && flavors[containerId]) {
								input.value = flavors[containerId];
								// Add a subtle load animation
								input.classList.add('animate-pulse');
								setTimeout(() => input.classList.remove('animate-pulse'), 300);
							}
						});
						
						console.log('‚úÖ Flavors loaded from localStorage');
					}
				} catch (error) {
					console.error('‚ùå Error loading flavors:', error);
					// Clear corrupted data
					localStorage.removeItem(STORAGE_KEY);
				}
			}

			// Enhanced function to save flavors to localStorage
			function saveFlavors() {
				try {
					const flavors = {};
					const inputs = document.querySelectorAll('.flavor-input');
					
					inputs.forEach(input => {
						const containerId = input.dataset.container;
						const value = input.value.trim();
						if (containerId && value) {
							flavors[containerId] = value;
						}
					});
					
					localStorage.setItem(STORAGE_KEY, JSON.stringify(flavors));
					
					// Enhanced save confirmation with smooth animation
					const status = document.getElementById('save-status');
					if (status) {
						status.innerHTML = `
							<svg class="w-4 h-4 text-green-500" fill="currentColor" viewBox="0 0 20 20">
								<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
							</svg>
							Guardado autom√°ticamente
						`;
						status.className = 'text-sm text-green-600 flex items-center justify-center gap-2 transition-all duration-300 transform scale-105';
						
						// Reset status message with smooth transition
						setTimeout(() => {
							status.innerHTML = `
								<svg class="w-4 h-4 opacity-60" fill="currentColor" viewBox="0 0 20 20">
									<path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" clip-rule="evenodd"></path>
								</svg>
								Los cambios se guardar√°n autom√°ticamente
							`;
							status.className = 'text-sm text-gray-500 flex items-center justify-center gap-2 transition-all duration-300';
						}, 2500);
					}
					
					console.log('‚úÖ Flavors saved to localStorage');
				} catch (error) {
					console.error('‚ùå Error saving flavors:', error);
					
					// Enhanced error message
					const status = document.getElementById('save-status');
					if (status) {
						status.innerHTML = `
							<svg class="w-4 h-4 text-red-500" fill="currentColor" viewBox="0 0 20 20">
								<path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
							</svg>
							Error al guardar
						`;
						status.className = 'text-sm text-red-600 flex items-center justify-center gap-2 transition-all duration-300';
						
						setTimeout(() => {
							status.innerHTML = `
								<svg class="w-4 h-4 opacity-60" fill="currentColor" viewBox="0 0 20 20">
									<path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" clip-rule="evenodd"></path>
								</svg>
								Los cambios se guardar√°n autom√°ticamente
							`;
							status.className = 'text-sm text-gray-500 flex items-center justify-center gap-2 transition-all duration-300';
						}, 3000);
					}
				}
			}

			// Debounce function to avoid too frequent saves
			function debounce(func, wait) {
				let timeout;
				return function executedFunction(...args) {
					const later = () => {
						clearTimeout(timeout);
						func(...args);
					};
					clearTimeout(timeout);
					timeout = setTimeout(later, wait);
				};
			}

			// Debounced save function (saves 300ms after user stops typing - faster feedback)
			const debouncedSave = debounce(saveFlavors, 300);

			// Initialize the app when DOM is loaded
			document.addEventListener('DOMContentLoaded', function() {
				// Add loading animation to main content
				const main = document.querySelector('main');
				main.style.opacity = '0';
				main.style.transform = 'translateY(20px)';
				
				setTimeout(() => {
					main.style.transition = 'all 0.6s ease-out';
					main.style.opacity = '1';
					main.style.transform = 'translateY(0)';
				}, 100);
				
				// Load existing flavors
				loadFlavors();
				
				// Add enhanced event listeners to all flavor inputs
				const inputs = document.querySelectorAll('.flavor-input');
				inputs.forEach(input => {
					// Save on input (typing) with faster response
					input.addEventListener('input', debouncedSave);
					
					// Save immediately on blur (when user leaves the field)
					input.addEventListener('blur', saveFlavors);
					
					// Add focus enhancement
					input.addEventListener('focus', function() {
						this.parentElement.parentElement.classList.add('ring-2', 'ring-blue-200', 'ring-opacity-50');
					});
					
					input.addEventListener('blur', function() {
						this.parentElement.parentElement.classList.remove('ring-2', 'ring-blue-200', 'ring-opacity-50');
					});
				});
				
				console.log('üç¶ D√≥nde Est√° Mi Helado? initialized with enhanced UX');
			});

			// Save data before page unload (backup)
			window.addEventListener('beforeunload', saveFlavors);
		</script>

		<!-- Custom CSS for additional animations -->
		<style>
			@keyframes fade-in {
				from {
					opacity: 0;
					transform: translateY(-10px);
				}
				to {
					opacity: 1;
					transform: translateY(0);
				}
			}

			@keyframes slide-up {
				from {
					opacity: 0;
					transform: translateY(30px);
				}
				to {
					opacity: 1;
					transform: translateY(0);
				}
			}

			.animate-fade-in {
				animation: fade-in 0.8s ease-out;
			}

			.animate-slide-up {
				animation: slide-up 0.6s ease-out 0.2s both;
			}

			/* Enhanced scroll behavior */
			html {
				scroll-behavior: smooth;
			}

			/* Custom focus styles for better accessibility */
			.flavor-input:focus {
				transform: translateY(-1px);
				box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
			}

			/* Backdrop blur support fallback */
			@supports not (backdrop-filter: blur(12px)) {
				.backdrop-blur-sm {
					background: rgba(255, 255, 255, 0.9);
				}
			}
		</style>
	</body>
</html>
